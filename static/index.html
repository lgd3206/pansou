// 修改 index.html 中的搜索函数，实现跳转逻辑

// 替换原有的 performProgressiveSearch 函数
function performProgressiveSearch(query = null, page = 1) {
    const searchInput = document.getElementById('searchInput');
    const keyword = query || searchInput.value.trim();
    
    if (!keyword) {
        showError('请输入搜索关键词');
        return;
    }
    
    // 跳转到搜索结果页，传递参数
    const searchUrl = new URL('search-results.html', window.location.href);
    searchUrl.searchParams.set('kw', keyword);
    if (page > 1) {
        searchUrl.searchParams.set('page', page);
    }
    
    // 跳转到结果页
    window.location.href = searchUrl.toString();
}

// 修改快速搜索函数
function quickSearch(keyword) {
    const searchUrl = new URL('search-results.html', window.location.href);
    searchUrl.searchParams.set('kw', keyword);
    window.location.href = searchUrl.toString();
}

// 保留错误提示函数（首页仍需要）
function showError(message) {
    const errorElement = document.getElementById('errorMessage');
    errorElement.textContent = message;
    errorElement.style.display = 'block';
    setTimeout(() => {
        errorElement.style.display = 'none';
    }, 5000);
}

// 页面加载完成后的初始化
document.addEventListener('DOMContentLoaded', function() {
    // 回车搜索
    document.getElementById('searchInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            performProgressiveSearch();
        }
    });

    // 输入时的实时处理
    document.getElementById('searchInput').addEventListener('input', function(e) {
        // 清理特殊字符
        this.value = this.value.replace(/[<>"']/g, '');
    });
});
